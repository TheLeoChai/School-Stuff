window.Keystone=Keystone||{};window.Keystone.Author=window.Keystone.Author||{};(function(e){Keystone.Utils.Author={clearErrors:function(){e("label[for='frmSubject']").removeClass("error");e("label[for='frmMessage']").removeClass("error")},clearForm:function(){var t=e("#frmSubject").val("");var n=e("#frmMessage").val("");Keystone.Utils.Author.clearErrors()},closeWindow:function(){Keystone.Utils.Author.clearForm();e("#emailAuthorOverlay").hide()}};e(".author-email").on("click",function(t){t.preventDefault();if(Keystone.UPM.Auth.userLogged&&Keystone.Cfg.tierId>0){var n=e(this).data("authorId");var r=e(this).data("authorName");e(".modalAuthorName").html(r);e("#frmAuthorId").val(n);e("#emailAuthorModal").show();e("#emailAuthorThanks").hide();e("#emailAuthorError").hide();e("#emailAuthorUpgrade").hide();e("#emailAuthorOverlay").show()}else{e("#emailAuthorModal").hide();e("#emailAuthorThanks").hide();e("#emailAuthorError").hide();e("#emailAuthorUpgrade").show();e("#emailAuthorOverlay").show()}});e("#emailAuthorSubmit").on("click",function(t){t.preventDefault();e("label[for='frmSubject']").removeClass("error");e("label[for='frmMessage']").removeClass("error");var n=e("#frmAuthorId").val();var r=true;var i=e("#frmSubject").val();var s=e("#frmMessage").val();if(i.trim()===""){r=false;e("label[for='frmSubject']").addClass("error")}if(s.trim()===""){r=false;e("label[for='frmMessage']").addClass("error")}if(r){var o={subject:i,message:s};e.ajax({type:"POST",url:"/email/author/"+n,contentType:"application/json; charset=utf-8",data:JSON.stringify(o),dataType:"json",success:function(t){if(t.success){e("#emailAuthorModal").hide();e("#emailAuthorThanks").show()}else{e("#emailAuthorModal").hide();e("#emailAuthorError").show()}},fail:function(){e("#emailAuthorModal").hide();e("#emailAuthorError").show()}})}});e("#closeAuthorModal").on("click",function(e){Keystone.Utils.Author.closeWindow()});e("#emailAuthorCancel").on("click",function(e){e.preventDefault();Keystone.Utils.Author.closeWindow()});e(".modalDone").on("click",function(e){e.preventDefault();Keystone.Utils.Author.closeWindow()})})(jQuery)